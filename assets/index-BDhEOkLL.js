import{r as h,a as wt,i as de,j as i,L as Ee,P as he,E as me,B as Re,T as pe,C as _e}from"./index-DVTBwKMH.js";import{u as Dt,U as ve,T as Te}from"./UserContext-CqxMbP7W.js";var zt={exports:{}},Jt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y=h;function Se(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ge=typeof Object.is=="function"?Object.is:Se,xe=Y.useState,Ce=Y.useEffect,we=Y.useLayoutEffect,De=Y.useDebugValue;function Oe(t,e){var n=e(),r=xe({inst:{value:n,getSnapshot:e}}),s=r[0].inst,o=r[1];return we(function(){s.value=n,s.getSnapshot=e,mt(s)&&o({inst:s})},[t,n,e]),Ce(function(){return mt(s)&&o({inst:s}),t(function(){mt(s)&&o({inst:s})})},[t]),De(n),n}function mt(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ge(t,n)}catch{return!0}}function be(t,e){return e()}var Le=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?be:Oe;Jt.useSyncExternalStore=Y.useSyncExternalStore!==void 0?Y.useSyncExternalStore:Le;zt.exports=Jt;var Ie=zt.exports;const M=()=>{},D=M(),ut=Object,c=t=>t===D,j=t=>typeof t=="function",P=(t,e)=>({...t,...e}),je=t=>j(t.then),at=new WeakMap;let Ae=0;const et=t=>{const e=typeof t,n=t&&t.constructor,r=n==Date;let s,o;if(ut(t)===t&&!r&&n!=RegExp){if(s=at.get(t),s)return s;if(s=++Ae+"~",at.set(t,s),n==Array){for(s="@",o=0;o<t.length;o++)s+=et(t[o])+",";at.set(t,s)}if(n==ut){s="#";const u=ut.keys(t).sort();for(;!c(o=u.pop());)c(t[o])||(s+=o+":"+et(t[o])+",");at.set(t,s)}}else s=r?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},F=new WeakMap,Rt={},ct={},Ot="undefined",ft=typeof window!=Ot,vt=typeof document!=Ot,ye=()=>ft&&typeof window.requestAnimationFrame!=Ot,Yt=(t,e)=>{const n=F.get(t);return[()=>!c(e)&&t.get(e)||Rt,r=>{if(!c(e)){const s=t.get(e);e in ct||(ct[e]=s),n[5](e,P(s,r),s||Rt)}},n[6],()=>!c(e)&&e in ct?ct[e]:!c(e)&&t.get(e)||Rt]};let Tt=!0;const Ne=()=>Tt,[St,gt]=ft&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[M,M],Ve=()=>{const t=vt&&document.visibilityState;return c(t)||t!=="hidden"},Ue=t=>(vt&&document.addEventListener("visibilitychange",t),St("focus",t),()=>{vt&&document.removeEventListener("visibilitychange",t),gt("focus",t)}),Fe=t=>{const e=()=>{Tt=!0,t()},n=()=>{Tt=!1};return St("online",e),St("offline",n),()=>{gt("online",e),gt("offline",n)}},Pe={isOnline:Ne,isVisible:Ve},We={initFocus:Ue,initReconnect:Fe},qt=!wt.useId,nt=!ft||"Deno"in window,Me=t=>ye()?window.requestAnimationFrame(t):setTimeout(t,1),lt=nt?h.useEffect:h.useLayoutEffect,pt=typeof navigator<"u"&&navigator.connection,kt=!nt&&pt&&(["slow-2g","2g"].includes(pt.effectiveType)||pt.saveData),bt=t=>{if(j(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?et(t):"",[t,e]};let $e=0;const xt=()=>++$e,Xt=0,Zt=1,Qt=2,qe=3;var tt={__proto__:null,ERROR_REVALIDATE_EVENT:qe,FOCUS_EVENT:Xt,MUTATE_EVENT:Qt,RECONNECT_EVENT:Zt};async function te(...t){const[e,n,r,s]=t,o=P({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let u=o.populateCache;const E=o.rollbackOnError;let l=o.optimisticData;const L=C=>typeof E=="function"?E(C):E!==!1,S=o.throwOnError;if(j(n)){const C=n,p=[],A=e.keys();for(const v of A)!/^\$(inf|sub)\$/.test(v)&&C(e.get(v)._k)&&p.push(v);return Promise.all(p.map(_))}return _(n);async function _(C){const[p]=bt(C);if(!p)return;const[A,v]=Yt(e,p),[dt,a,rt,Z]=F.get(e),W=()=>{const I=dt[p];return(j(o.revalidate)?o.revalidate(A().data,C):o.revalidate!==!1)&&(delete rt[p],delete Z[p],I&&I[0])?I[0](Qt).then(()=>A().data):A().data};if(t.length<3)return W();let g=r,O;const q=xt();a[p]=[q,0];const R=!c(l),k=A(),y=k.data,B=k._c,$=c(B)?y:B;if(R&&(l=j(l)?l($,y):l,v({data:l,_c:$})),j(g))try{g=g($)}catch(I){O=I}if(g&&je(g))if(g=await g.catch(I=>{O=I}),q!==a[p][0]){if(O)throw O;return g}else O&&R&&L(O)&&(u=!0,v({data:$,_c:D}));if(u&&!O)if(j(u)){const I=u(g,$);v({data:I,error:D,_c:D})}else v({data:g,error:D,_c:D});if(a[p][1]=xt(),Promise.resolve(W()).then(()=>{v({_c:D})}),O){if(S)throw O;return}return g}}const Bt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},ee=(t,e)=>{if(!F.has(t)){const n=P(We,e),r={},s=te.bind(D,t);let o=M;const u={},E=(S,_)=>{const C=u[S]||[];return u[S]=C,C.push(_),()=>C.splice(C.indexOf(_),1)},l=(S,_,C)=>{t.set(S,_);const p=u[S];if(p)for(const A of p)A(_,C)},L=()=>{if(!F.has(t)&&(F.set(t,[r,{},{},{},s,l,E]),!nt)){const S=n.initFocus(setTimeout.bind(D,Bt.bind(D,r,Xt))),_=n.initReconnect(setTimeout.bind(D,Bt.bind(D,r,Zt)));o=()=>{S&&S(),_&&_(),F.delete(t)}}};return L(),[t,s,L,o]}return[t,F.get(t)[4]]},ke=(t,e,n,r,s)=>{const o=n.errorRetryCount,u=s.retryCount,E=~~((Math.random()+.5)*(1<<(u<8?u:8)))*n.errorRetryInterval;!c(o)&&u>o||setTimeout(r,E,s)},Be=(t,e)=>et(t)==et(e),[Lt,He]=ee(new Map),ne=P({onLoadingSlow:M,onSuccess:M,onError:M,onErrorRetry:ke,onDiscarded:M,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:kt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:kt?5e3:3e3,compare:Be,isPaused:()=>!1,cache:Lt,mutate:He,fallback:{}},Pe),se=(t,e)=>{const n=P(t,e);if(e){const{use:r,fallback:s}=t,{use:o,fallback:u}=e;r&&o&&(n.use=r.concat(o)),s&&u&&(n.fallback=P(s,u))}return n},Ct=h.createContext({}),Ge=t=>{const{value:e}=t,n=h.useContext(Ct),r=j(e),s=h.useMemo(()=>r?e(n):e,[r,n,e]),o=h.useMemo(()=>r?s:se(n,s),[r,n,s]),u=s&&s.provider,E=h.useRef(D);u&&!E.current&&(E.current=ee(u(o.cache||Lt),s));const l=E.current;return l&&(o.cache=l[0],o.mutate=l[1]),lt(()=>{if(l)return l[2]&&l[2](),l[3]},[]),h.createElement(Ct.Provider,P(t,{value:o}))},Ke="$inf$",re=ft&&window.__SWR_DEVTOOLS_USE__,ze=re?window.__SWR_DEVTOOLS_USE__:[],Je=()=>{re&&(window.__SWR_DEVTOOLS_REACT__=wt)},Ye=t=>j(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],oe=()=>P(ne,h.useContext(Ct)),Xe=t=>(e,n,r)=>t(e,n&&((...o)=>{const[u]=bt(e),[,,,E]=F.get(Lt);if(u.startsWith(Ke))return n(...o);const l=E[u];return c(l)?n(...o):(delete E[u],l)}),r),Ze=ze.concat(Xe),Qe=t=>function(...n){const r=oe(),[s,o,u]=Ye(n),E=se(r,u);let l=t;const{use:L}=E,S=(L||[]).concat(Ze);for(let _=S.length;_--;)l=S[_](l);return l(s,o||E.fetcher||null,E)},tn=(t,e,n)=>{const r=e[t]||(e[t]=[]);return r.push(n),()=>{const s=r.indexOf(n);s>=0&&(r[s]=r[r.length-1],r.pop())}};Je();const Ht=wt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),_t={dedupe:!0},en=(t,e,n)=>{const{cache:r,compare:s,suspense:o,fallbackData:u,revalidateOnMount:E,revalidateIfStale:l,refreshInterval:L,refreshWhenHidden:S,refreshWhenOffline:_,keepPreviousData:C}=n,[p,A,v,dt]=F.get(r),[a,rt]=bt(t),Z=h.useRef(!1),W=h.useRef(!1),g=h.useRef(a),O=h.useRef(e),q=h.useRef(n),R=()=>q.current,k=()=>R().isVisible()&&R().isOnline(),[y,B,$,I]=Yt(r,a),H=h.useRef({}).current,ae=c(u)?n.fallback[a]:u,At=(f,d)=>{for(const x in H){const m=x;if(m==="data"){if(!s(f[m],d[m])&&(!c(f[m])||!s(it,d[m])))return!1}else if(d[m]!==f[m])return!1}return!0},yt=h.useMemo(()=>{const f=!a||!e?!1:c(E)?R().isPaused()||o?!1:c(l)?!0:l:E,d=w=>{const V=P(w);return delete V._k,f?{isValidating:!0,isLoading:!0,...V}:V},x=y(),m=I(),N=d(x),J=x===m?N:d(m);let T=N;return[()=>{const w=d(y());return At(w,T)?(T.data=w.data,T.isLoading=w.isLoading,T.isValidating=w.isValidating,T.error=w.error,T):(T=w,w)},()=>J]},[r,a]),G=Ie.useSyncExternalStore(h.useCallback(f=>$(a,(d,x)=>{At(x,d)||f()}),[r,a]),yt[0],yt[1]),Nt=!Z.current,ce=p[a]&&p[a].length>0,K=G.data,z=c(K)?ae:K,ot=G.error,Vt=h.useRef(z),it=C?c(K)?Vt.current:K:z,Ut=ce&&!c(ot)?!1:Nt&&!c(E)?E:R().isPaused()?!1:o?c(z)?!1:l:c(z)||l,Ft=!!(a&&e&&Nt&&Ut),ue=c(G.isValidating)?Ft:G.isValidating,le=c(G.isLoading)?Ft:G.isLoading,Q=h.useCallback(async f=>{const d=O.current;if(!a||!d||W.current||R().isPaused())return!1;let x,m,N=!0;const J=f||{},T=!v[a]||!J.dedupe,w=()=>qt?!W.current&&a===g.current&&Z.current:a===g.current,V={isValidating:!1,isLoading:!1},Wt=()=>{B(V)},Mt=()=>{const b=v[a];b&&b[1]===m&&delete v[a]},$t={isValidating:!0};c(y().data)&&($t.isLoading=!0);try{if(T&&(B($t),n.loadingTimeout&&c(y().data)&&setTimeout(()=>{N&&w()&&R().onLoadingSlow(a,n)},n.loadingTimeout),v[a]=[d(rt),xt()]),[x,m]=v[a],x=await x,T&&setTimeout(Mt,n.dedupingInterval),!v[a]||v[a][1]!==m)return T&&w()&&R().onDiscarded(a),!1;V.error=D;const b=A[a];if(!c(b)&&(m<=b[0]||m<=b[1]||b[1]===0))return Wt(),T&&w()&&R().onDiscarded(a),!1;const U=y().data;V.data=s(U,x)?U:x,T&&w()&&R().onSuccess(x,a,n)}catch(b){Mt();const U=R(),{shouldRetryOnError:Et}=U;U.isPaused()||(V.error=b,T&&w()&&(U.onError(b,a,U),(Et===!0||j(Et)&&Et(b))&&(!R().revalidateOnFocus||!R().revalidateOnReconnect||k())&&U.onErrorRetry(b,a,U,fe=>{const ht=p[a];ht&&ht[0]&&ht[0](tt.ERROR_REVALIDATE_EVENT,fe)},{retryCount:(J.retryCount||0)+1,dedupe:!0})))}return N=!1,Wt(),!0},[a,r]),Pt=h.useCallback((...f)=>te(r,g.current,...f),[]);if(lt(()=>{O.current=e,q.current=n,c(K)||(Vt.current=K)}),lt(()=>{if(!a)return;const f=Q.bind(D,_t);let d=0;const m=tn(a,p,(N,J={})=>{if(N==tt.FOCUS_EVENT){const T=Date.now();R().revalidateOnFocus&&T>d&&k()&&(d=T+R().focusThrottleInterval,f())}else if(N==tt.RECONNECT_EVENT)R().revalidateOnReconnect&&k()&&f();else{if(N==tt.MUTATE_EVENT)return Q();if(N==tt.ERROR_REVALIDATE_EVENT)return Q(J)}});return W.current=!1,g.current=a,Z.current=!0,B({_k:rt}),Ut&&(c(z)||nt?f():Me(f)),()=>{W.current=!0,m()}},[a]),lt(()=>{let f;function d(){const m=j(L)?L(y().data):L;m&&f!==-1&&(f=setTimeout(x,m))}function x(){!y().error&&(S||R().isVisible())&&(_||R().isOnline())?Q(_t).then(d):d()}return d(),()=>{f&&(clearTimeout(f),f=-1)}},[L,S,_,a]),h.useDebugValue(it),o&&c(z)&&a){if(!qt&&nt)throw new Error("Fallback data is required when using suspense in SSR.");O.current=e,q.current=n,W.current=!1;const f=dt[a];if(!c(f)){const d=Pt(f);Ht(d)}if(c(ot)){const d=Q(_t);c(it)||(d.status="fulfilled",d.value=!0),Ht(d)}else throw ot}return{mutate:Pt,get data(){return H.data=!0,it},get error(){return H.error=!0,ot},get isValidating(){return H.isValidating=!0,ue},get isLoading(){return H.isLoading=!0,le}}},nn=ut.defineProperty(Ge,"defaultValue",{value:ne}),It=Qe(en),sn=de.create({baseURL:"https://jsonplaceholder.typicode.com/"});async function rn(t){return(await sn.get(t)).data}var X=(t=>(t.USER_DETAILS="user-details",t.TODO_LIST="todo-list",t.LAST_UPDATED="last-updated",t))(X||{});const st={"user-details":t=>`users/${t}`,"todo-list":t=>`todos?userId=${t}`,"last-updated":()=>"lastUpdated"};function jt(){const{userId:t}=Dt(),e=st[X.USER_DETAILS];return It(e(t))}const on="_loading_1f6xf_1",an="_error_1f6xf_7",Gt={loading:on,error:an};function cn(){const{isValidating:t,data:e,error:n}=jt();return t?i.jsx("div",{className:Gt.loading,children:i.jsx(Ee,{})}):n?i.jsx("div",{className:Gt.error,children:"Oops! Something went wrong..."}):i.jsx(he,{data:e})}function ie(){const{userId:t}=Dt(),e=st[X.TODO_LIST];return It(e(t))}function un(){const{data:t,mutate:e}=ie();return i.jsxs("table",{children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{children:i.jsx(me,{emoji:"ðŸ”„",tooltip:"Refetch",onClick:()=>e()})}),i.jsx("th",{children:"Title"}),i.jsx("th",{children:"Completed"})]})}),i.jsx("tbody",{children:t==null?void 0:t.map((n,r)=>i.jsxs("tr",{children:[i.jsx("td",{children:r+1}),i.jsx("td",{children:n.title}),i.jsx("td",{children:n.completed?"âœ…":null})]},n.id))})]})}const ln="_avatar_jpqt5_1",fn={avatar:ln};function dn(){const{data:t}=jt();return((t==null?void 0:t.name)??"").split(" ").map(n=>n.charAt(0)).join("")}function En(){const t=dn();return i.jsx("div",{className:fn.avatar,children:t})}const hn={refreshInterval:3e3};function mn(){return new Promise(t=>{t(new Date)})}function Rn(){const t=st[X.LAST_UPDATED];return It(t(),mn,hn)}const pn="_lastUpdated_13tp4_1",_n={lastUpdated:pn};function vn(){const{data:t}=Rn(),e=(t==null?void 0:t.toLocaleTimeString())??"--";return i.jsxs("div",{className:_n.lastUpdated,children:["Last updated:",i.jsx("br",{}),i.jsx("strong",{children:e})]})}function Tn(){const{userId:t}=Dt(),{mutate:e}=oe(),n=()=>{e(st[X.USER_DETAILS](t)),e(st[X.TODO_LIST](t))};return i.jsx(Re,{text:"Refresh all",onClick:n})}const Sn="_todoCounter_1n29n_1",gn={todoCounter:Sn};function xn(){const{data:t}=ie(),e=(t==null?void 0:t.length)??0;return i.jsxs("div",{className:gn.todoCounter,children:["Todos:",i.jsx("br",{}),i.jsx("strong",{children:e})]})}const Cn="_userName_1v8vf_1",wn="_userEmail_1v8vf_5",Kt={userName:Cn,userEmail:wn};function Dn(){const{data:t}=jt();return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:Kt.userName,children:t==null?void 0:t.name}),i.jsx("div",{className:Kt.userEmail,children:t==null?void 0:t.email})]})}function On(){return i.jsxs(pe,{children:[i.jsx(En,{}),i.jsx("div",{style:{flex:1},children:i.jsx(Dn,{})}),i.jsx(xn,{}),i.jsx(vn,{}),i.jsx(Tn,{})]})}const bn=["ðŸ‘¤ User Profile","âœ… Todos List"];function jn(){return i.jsx(_e,{title:"SWR",subtitle:"Data fetching",children:i.jsx(nn,{value:{fetcher:rn},children:i.jsxs(ve,{children:[i.jsx(On,{}),i.jsxs(Te,{tabs:bn,children:[i.jsx(cn,{}),i.jsx(un,{})]})]})})})}export{jn as default};
