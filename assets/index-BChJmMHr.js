import{r as m,i as yt,j as o}from"./vendor-BxO9C8ng.js";import{u as Lt,U as Ee,T as ve}from"./UserContext-CH6FmWrV.js";import{L as Se,P as Re,E as ge,B as _e,T as Te,C as we}from"./index-0OOx0rPj.js";var Zt={exports:{}},Qt={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J=m;function xe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ce=typeof Object.is=="function"?Object.is:xe,Oe=J.useState,je=J.useEffect,De=J.useLayoutEffect,ye=J.useDebugValue;function Le(t,e){var n=e(),s=Oe({inst:{value:n,getSnapshot:e}}),r=s[0].inst,a=s[1];return De(function(){r.value=n,r.getSnapshot=e,mt(r)&&a({inst:r})},[t,n,e]),je(function(){return mt(r)&&a({inst:r}),t(function(){mt(r)&&a({inst:r})})},[t]),ye(n),n}function mt(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ce(t,n)}catch{return!0}}function Ie(t,e){return e()}var be=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Ie:Le;Qt.useSyncExternalStore=J.useSyncExternalStore!==void 0?J.useSyncExternalStore:be;Zt.exports=Qt;var Ae=Zt.exports;const te=0,ee=1,ne=2,Ht=3;var Gt=Object.prototype.hasOwnProperty;function _t(t,e){var n,s;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((s=t.length)===e.length)for(;s--&&_t(t[s],e[s]););return s===-1}if(!n||typeof t=="object"){s=0;for(n in t)if(Gt.call(t,n)&&++s&&!Gt.call(e,n)||!(n in e)||!_t(t[n],e[n]))return!1;return Object.keys(e).length===s}}return t!==t&&e!==e}const F=new WeakMap,$=()=>{},x=$(),lt=Object,u=t=>t===x,I=t=>typeof t=="function",W=(t,e)=>({...t,...e}),se=t=>I(t.then),Et={},ct={},It="undefined",nt=typeof window!=It,Tt=typeof document!=It,Ne=nt&&"Deno"in window,Ue=()=>nt&&typeof window.requestAnimationFrame!=It,re=(t,e)=>{const n=F.get(t);return[()=>!u(e)&&t.get(e)||Et,s=>{if(!u(e)){const r=t.get(e);e in ct||(ct[e]=r),n[5](e,W(r,s),r||Et)}},n[6],()=>!u(e)&&e in ct?ct[e]:!u(e)&&t.get(e)||Et]};let wt=!0;const Ve=()=>wt,[xt,Ct]=nt&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[$,$],Pe=()=>{const t=Tt&&document.visibilityState;return u(t)||t!=="hidden"},Fe=t=>(Tt&&document.addEventListener("visibilitychange",t),xt("focus",t),()=>{Tt&&document.removeEventListener("visibilitychange",t),Ct("focus",t)}),We=t=>{const e=()=>{wt=!0,t()},n=()=>{wt=!1};return xt("online",e),xt("offline",n),()=>{Ct("online",e),Ct("offline",n)}},Me={isOnline:Ve,isVisible:Pe},$e={initFocus:Fe,initReconnect:We},Kt=!yt.useId,tt=!nt||Ne,qe=t=>Ue()?window.requestAnimationFrame(t):setTimeout(t,1),ut=tt?m.useEffect:m.useLayoutEffect,vt=typeof navigator<"u"&&navigator.connection,zt=!tt&&vt&&(["slow-2g","2g"].includes(vt.effectiveType)||vt.saveData),at=new WeakMap,ke=t=>lt.prototype.toString.call(t),St=(t,e)=>t===`[object ${e}]`;let Be=0;const Ot=t=>{const e=typeof t,n=ke(t),s=St(n,"Date"),r=St(n,"RegExp"),a=St(n,"Object");let i,l;if(lt(t)===t&&!s&&!r){if(i=at.get(t),i)return i;if(i=++Be+"~",at.set(t,i),Array.isArray(t)){for(i="@",l=0;l<t.length;l++)i+=Ot(t[l])+",";at.set(t,i)}if(a){i="#";const f=lt.keys(t).sort();for(;!u(l=f.pop());)u(t[l])||(i+=l+":"+Ot(t[l])+",");at.set(t,i)}}else i=s?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return i},bt=t=>{if(I(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?Ot(t):"",[t,e]};let He=0;const jt=()=>++He;async function oe(...t){const[e,n,s,r]=t,a=W({populateCache:!0,throwOnError:!0},typeof r=="boolean"?{revalidate:r}:r||{});let i=a.populateCache;const l=a.rollbackOnError;let f=a.optimisticData;const y=C=>typeof l=="function"?l(C):l!==!1,_=a.throwOnError;if(I(n)){const C=n,v=[],b=e.keys();for(const S of b)!/^\$(inf|sub)\$/.test(S)&&C(e.get(S)._k)&&v.push(S);return Promise.all(v.map(R))}return R(n);async function R(C){const[v]=bt(C);if(!v)return;const[b,S]=re(e,v),[ft,c,st,X]=F.get(e),M=()=>{const O=ft[v];return(I(a.revalidate)?a.revalidate(b().data,C):a.revalidate!==!1)&&(delete st[v],delete X[v],O&&O[0])?O[0](ne).then(()=>b().data):b().data};if(t.length<3)return M();let T=s,U,A=!1;const p=jt();c[v]=[p,0];const B=!u(f),N=b(),H=N.data,rt=N._c,q=u(rt)?H:rt;if(B&&(f=I(f)?f(q,H):f,S({data:f,_c:q})),I(T))try{T=T(q)}catch(O){U=O,A=!0}if(T&&se(T))if(T=await T.catch(O=>{U=O,A=!0}),p!==c[v][0]){if(A)throw U;return T}else A&&B&&y(U)&&(i=!0,S({data:q,_c:x}));if(i&&!A)if(I(i)){const O=i(T,q);S({data:O,error:x,_c:x})}else S({data:T,error:x,_c:x});if(c[v][1]=jt(),Promise.resolve(M()).then(()=>{S({_c:x})}),A){if(_)throw U;return}return T}}const Jt=(t,e)=>{for(const n in t)t[n][0]&&t[n][0](e)},ie=(t,e)=>{if(!F.has(t)){const n=W($e,e),s=Object.create(null),r=oe.bind(x,t);let a=$;const i=Object.create(null),l=(_,R)=>{const C=i[_]||[];return i[_]=C,C.push(R),()=>C.splice(C.indexOf(R),1)},f=(_,R,C)=>{t.set(_,R);const v=i[_];if(v)for(const b of v)b(R,C)},y=()=>{if(!F.has(t)&&(F.set(t,[s,Object.create(null),Object.create(null),Object.create(null),r,f,l]),!tt)){const _=n.initFocus(setTimeout.bind(x,Jt.bind(x,s,te))),R=n.initReconnect(setTimeout.bind(x,Jt.bind(x,s,ee)));a=()=>{_&&_(),R&&R(),F.delete(t)}}};return y(),[t,r,y,a]}return[t,F.get(t)[4]]},Ge=(t,e,n,s,r)=>{const a=n.errorRetryCount,i=r.retryCount,l=~~((Math.random()+.5)*(1<<(i<8?i:8)))*n.errorRetryInterval;!u(a)&&i>a||setTimeout(s,l,r)},Ke=_t,[At,ze]=ie(new Map),ce=W({onLoadingSlow:$,onSuccess:$,onError:$,onErrorRetry:Ge,onDiscarded:$,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:zt?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:zt?5e3:3e3,compare:Ke,isPaused:()=>!1,cache:At,mutate:ze,fallback:{}},Me),ae=(t,e)=>{const n=W(t,e);if(e){const{use:s,fallback:r}=t,{use:a,fallback:i}=e;s&&a&&(n.use=s.concat(a)),r&&i&&(n.fallback=W(r,i))}return n},Dt=m.createContext({}),Je=t=>{const{value:e}=t,n=m.useContext(Dt),s=I(e),r=m.useMemo(()=>s?e(n):e,[s,n,e]),a=m.useMemo(()=>s?r:ae(n,r),[s,n,r]),i=r&&r.provider,l=m.useRef(x);i&&!l.current&&(l.current=ie(i(a.cache||At),r));const f=l.current;return f&&(a.cache=f[0],a.mutate=f[1]),ut(()=>{if(f)return f[2]&&f[2](),f[3]},[]),m.createElement(Dt.Provider,W(t,{value:a}))},Ye="$inf$",ue=nt&&window.__SWR_DEVTOOLS_USE__,Xe=ue?window.__SWR_DEVTOOLS_USE__:[],Ze=()=>{ue&&(window.__SWR_DEVTOOLS_REACT__=yt)},Qe=t=>I(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],le=()=>W(ce,m.useContext(Dt)),tn=t=>(e,n,s)=>t(e,n&&((...a)=>{const[i]=bt(e),[,,,l]=F.get(At);if(i.startsWith(Ye))return n(...a);const f=l[i];return u(f)?n(...a):(delete l[i],f)}),s),en=Xe.concat(tn),nn=t=>function(...n){const s=le(),[r,a,i]=Qe(n),l=ae(s,i);let f=t;const{use:y}=l,_=(y||[]).concat(en);for(let R=_.length;R--;)f=_[R](f);return f(r,a||l.fetcher||null,l)},sn=(t,e,n)=>{const s=e[t]||(e[t]=[]);return s.push(n),()=>{const r=s.indexOf(n);r>=0&&(s[r]=s[s.length-1],s.pop())}};Ze();const Rt=yt.use||(t=>{switch(t.status){case"pending":throw t;case"fulfilled":return t.value;case"rejected":throw t.reason;default:throw t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t}}),gt={dedupe:!0},rn=(t,e,n)=>{const{cache:s,compare:r,suspense:a,fallbackData:i,revalidateOnMount:l,revalidateIfStale:f,refreshInterval:y,refreshWhenHidden:_,refreshWhenOffline:R,keepPreviousData:C}=n,[v,b,S,ft]=F.get(s),[c,st]=bt(t),X=m.useRef(!1),M=m.useRef(!1),T=m.useRef(c),U=m.useRef(e),A=m.useRef(n),p=()=>A.current,B=()=>p().isVisible()&&p().isOnline(),[N,H,rt,q]=re(s,c),O=m.useRef({}).current,Z=u(i)?u(n.fallback)?x:n.fallback[c]:i,Vt=(h,d)=>{for(const w in O){const E=w;if(E==="data"){if(!r(h[E],d[E])&&(!u(h[E])||!r(it,d[E])))return!1}else if(d[E]!==h[E])return!1}return!0},Pt=m.useMemo(()=>{const h=!c||!e?!1:u(l)?p().isPaused()||a?!1:f!==!1:l,d=j=>{const V=W(j);return delete V._k,h?{isValidating:!0,isLoading:!0,...V}:V},w=N(),E=q(),L=d(w),z=w===E?L:d(E);let g=L;return[()=>{const j=d(N());return Vt(j,g)?(g.data=j.data,g.isLoading=j.isLoading,g.isValidating=j.isValidating,g.error=j.error,g):(g=j,j)},()=>z]},[s,c]),G=Ae.useSyncExternalStore(m.useCallback(h=>rt(c,(d,w)=>{Vt(w,d)||h()}),[s,c]),Pt[0],Pt[1]),Ft=!X.current,de=v[c]&&v[c].length>0,K=G.data,k=u(K)?Z&&se(Z)?Rt(Z):Z:K,ot=G.error,dt=m.useRef(k),it=C?u(K)?u(dt.current)?k:dt.current:K:k,Wt=de&&!u(ot)?!1:Ft&&!u(l)?l:p().isPaused()?!1:a?u(k)?!1:f:u(k)||f,Mt=!!(c&&e&&Ft&&Wt),he=u(G.isValidating)?Mt:G.isValidating,pe=u(G.isLoading)?Mt:G.isLoading,Q=m.useCallback(async h=>{const d=U.current;if(!c||!d||M.current||p().isPaused())return!1;let w,E,L=!0;const z=h||{},g=!S[c]||!z.dedupe,j=()=>Kt?!M.current&&c===T.current&&X.current:c===T.current,V={isValidating:!1,isLoading:!1},qt=()=>{H(V)},kt=()=>{const D=S[c];D&&D[1]===E&&delete S[c]},Bt={isValidating:!0};u(N().data)&&(Bt.isLoading=!0);try{if(g&&(H(Bt),n.loadingTimeout&&u(N().data)&&setTimeout(()=>{L&&j()&&p().onLoadingSlow(c,n)},n.loadingTimeout),S[c]=[d(st),jt()]),[w,E]=S[c],w=await w,g&&setTimeout(kt,n.dedupingInterval),!S[c]||S[c][1]!==E)return g&&j()&&p().onDiscarded(c),!1;V.error=x;const D=b[c];if(!u(D)&&(E<=D[0]||E<=D[1]||D[1]===0))return qt(),g&&j()&&p().onDiscarded(c),!1;const P=N().data;V.data=r(P,w)?P:w,g&&j()&&p().onSuccess(w,c,n)}catch(D){kt();const P=p(),{shouldRetryOnError:ht}=P;P.isPaused()||(V.error=D,g&&j()&&(P.onError(D,c,P),(ht===!0||I(ht)&&ht(D))&&(!p().revalidateOnFocus||!p().revalidateOnReconnect||B())&&P.onErrorRetry(D,c,P,me=>{const pt=v[c];pt&&pt[0]&&pt[0](Ht,me)},{retryCount:(z.retryCount||0)+1,dedupe:!0})))}return L=!1,qt(),!0},[c,s]),$t=m.useCallback((...h)=>oe(s,T.current,...h),[]);if(ut(()=>{U.current=e,A.current=n,u(K)||(dt.current=K)}),ut(()=>{if(!c)return;const h=Q.bind(x,gt);let d=0;p().revalidateOnFocus&&(d=Date.now()+p().focusThrottleInterval);const E=sn(c,v,(L,z={})=>{if(L==te){const g=Date.now();p().revalidateOnFocus&&g>d&&B()&&(d=g+p().focusThrottleInterval,h())}else if(L==ee)p().revalidateOnReconnect&&B()&&h();else{if(L==ne)return Q();if(L==Ht)return Q(z)}});return M.current=!1,T.current=c,X.current=!0,H({_k:st}),Wt&&(S[c]||(u(k)||tt?h():qe(h))),()=>{M.current=!0,E()}},[c]),ut(()=>{let h;function d(){const E=I(y)?y(N().data):y;E&&h!==-1&&(h=setTimeout(w,E))}function w(){!N().error&&(_||p().isVisible())&&(R||p().isOnline())?Q(gt).then(d):d()}return d(),()=>{h&&(clearTimeout(h),h=-1)}},[y,_,R,c]),m.useDebugValue(it),a&&u(k)&&c){if(!Kt&&tt)throw new Error("Fallback data is required when using Suspense in SSR.");U.current=e,A.current=n,M.current=!1;const h=ft[c];if(!u(h)){const d=$t(h);Rt(d)}if(u(ot)){const d=Q(gt);u(it)||(d.status="fulfilled",d.value=!0),Rt(d)}else throw ot}return{mutate:$t,get data(){return O.data=!0,it},get error(){return O.error=!0,ot},get isValidating(){return O.isValidating=!0,he},get isLoading(){return O.isLoading=!0,pe}}},on=lt.defineProperty(Je,"defaultValue",{value:ce}),Nt=nn(rn);async function cn(t,e){return(await fetch(`https://jsonplaceholder.typicode.com/${t}`,e)).json()}var Y=(t=>(t.USER_DETAILS="user-details",t.TODO_LIST="todo-list",t.LAST_UPDATED="last-updated",t))(Y||{});const et={"user-details":t=>`users/${t}`,"todo-list":t=>`todos?userId=${t}`,"last-updated":()=>"lastUpdated"};function Ut(){const{userId:t}=Lt(),e=et[Y.USER_DETAILS];return Nt(e(t))}const an="_loading_1f6xf_1",un="_error_1f6xf_7",Yt={loading:an,error:un};function ln(){const{isValidating:t,data:e,error:n}=Ut();return t?o.jsx("div",{className:Yt.loading,children:o.jsx(Se,{})}):n?o.jsx("div",{className:Yt.error,children:"Oops! Something went wrong..."}):o.jsx(Re,{data:e})}function fe(){const{userId:t}=Lt(),e=et[Y.TODO_LIST];return Nt(e(t))}function fn(){const{data:t,mutate:e}=fe();return o.jsxs("table",{children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:o.jsx(ge,{emoji:"🔄",tooltip:"Refetch",onClick:()=>e()})}),o.jsx("th",{children:"Title"}),o.jsx("th",{children:"Completed"})]})}),o.jsx("tbody",{children:t==null?void 0:t.map((n,s)=>o.jsxs("tr",{children:[o.jsx("td",{children:s+1}),o.jsx("td",{children:n.title}),o.jsx("td",{children:n.completed?"✅":null})]},n.id))})]})}const dn="_avatar_jpqt5_1",hn={avatar:dn};function pn(){const{data:t}=Ut();return((t==null?void 0:t.name)??"").split(" ").map(n=>n.charAt(0)).join("")}function mn(){const t=pn();return o.jsx("div",{className:hn.avatar,children:t})}const En={refreshInterval:3e3};function vn(){return new Promise(t=>{t(new Date)})}function Sn(){const t=et[Y.LAST_UPDATED];return Nt(t(),vn,En)}const Rn="_lastUpdated_13tp4_1",gn={lastUpdated:Rn};function _n(){const{data:t}=Sn(),e=(t==null?void 0:t.toLocaleTimeString())??"--";return o.jsxs("div",{className:gn.lastUpdated,children:["Last updated:",o.jsx("br",{}),o.jsx("strong",{children:e})]})}function Tn(){const{userId:t}=Lt(),{mutate:e}=le(),n=()=>{e(et[Y.USER_DETAILS](t)),e(et[Y.TODO_LIST](t))};return o.jsx(_e,{text:"Refresh all",onClick:n})}const wn="_todoCounter_1n29n_1",xn={todoCounter:wn};function Cn(){const{data:t}=fe(),e=(t==null?void 0:t.length)??0;return o.jsxs("div",{className:xn.todoCounter,children:["Todos:",o.jsx("br",{}),o.jsx("strong",{children:e})]})}const On="_userName_1v8vf_1",jn="_userEmail_1v8vf_5",Xt={userName:On,userEmail:jn};function Dn(){const{data:t}=Ut();return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:Xt.userName,children:t==null?void 0:t.name}),o.jsx("div",{className:Xt.userEmail,children:t==null?void 0:t.email})]})}function yn(){return o.jsxs(Te,{children:[o.jsx(mn,{}),o.jsx("div",{style:{flex:1},children:o.jsx(Dn,{})}),o.jsx(Cn,{}),o.jsx(_n,{}),o.jsx(Tn,{})]})}const Ln=["👤 User Profile","✅ Todos List"];function Un(){return o.jsx(we,{title:"SWR",subtitle:"Data fetching",children:o.jsx(on,{value:{fetcher:cn},children:o.jsxs(Ee,{children:[o.jsx(yn,{}),o.jsxs(ve,{tabs:Ln,children:[o.jsx(ln,{}),o.jsx(fn,{})]})]})})})}export{Un as default};
