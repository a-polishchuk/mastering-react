import{r as A,i as le,j as x}from"./vendor-D9SnsUke.js";import{B as Z,C as pe,T as we}from"./index-BfsiAeQW.js";import{C as ye}from"./CheckboxGrid-BltSeU-8.js";import{D as Ee}from"./DivGrid-CA1cIOHx.js";import{e as be,t as xe,u as Ce,G as Ae,c as Te,r as Ie,n as je}from"./useAutoGeneration-zbev-21w.js";const R={},m=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,H=e=>"init"in e,K=e=>!!e.write,ee=e=>"v"in e||"e"in e,W=e=>{if("e"in e)throw e.e;if((R?"production":void 0)!=="production"&&!("v"in e))throw new Error("[Bug] atom state is not initialized");return e.v},V=new WeakMap,te=e=>{var t;return M(e)&&!!((t=V.get(e))!=null&&t[0])},De=e=>{const t=V.get(e);t!=null&&t[0]&&(t[0]=!1,t[1].forEach(n=>n()))},ue=(e,t)=>{let n=V.get(e);if(!n){n=[!0,new Set],V.set(e,n);const o=()=>{n[0]=!1};e.then(o,o)}n[1].add(t)},M=e=>typeof(e==null?void 0:e.then)=="function",de=(e,t,n)=>{n.p.has(e)||(n.p.add(e),t.then(()=>{n.p.delete(e)},()=>{n.p.delete(e)}))},X=(e,t,n)=>{const o=n(e),s="v"in o,a=o.v;if(M(t))for(const u of o.d.keys())de(e,t,n(u));o.v=t,delete o.e,(!s||!Object.is(a,o.v))&&(++o.n,M(a)&&De(a))},ne=(e,t,n)=>{var o;const s=new Set;for(const a of((o=n.get(e))==null?void 0:o.t)||[])n.has(a)&&s.add(a);for(const a of t.p)s.add(a);return s},Le=()=>{const e=new Set,t=()=>{e.forEach(n=>n())};return t.add=n=>(e.add(n),()=>{e.delete(n)}),t},$=()=>{const e={},t=new WeakMap,n=o=>{var s,a;(s=t.get(e))==null||s.forEach(u=>u(o)),(a=t.get(o))==null||a.forEach(u=>u())};return n.add=(o,s)=>{const a=o||e,u=(t.has(a)?t:t.set(a,new Set)).get(a);return u.add(s),()=>{u==null||u.delete(s),u.size||t.delete(a)}},n},Re=e=>(e.c||(e.c=$()),e.m||(e.m=$()),e.u||(e.u=$()),e.f||(e.f=Le()),e),Pe=Symbol(),ze=(e=new WeakMap,t=new WeakMap,n=new WeakMap,o=new Set,s=new Set,a=new Set,u={},h=(_,...E)=>_.read(...E),w=(_,...E)=>_.write(...E),v=(_,E)=>{var C;return(C=_.unstable_onInit)==null?void 0:C.call(_,E)},g=(_,E)=>{var C;return(C=_.onMount)==null?void 0:C.call(_,E)},...p)=>{const _=p[0]||(r=>{if((R?"production":void 0)!=="production"&&!r)throw new Error("Atom is undefined or null");let f=e.get(r);return f||(f={d:new Map,p:new Set,n:0},e.set(r,f),v==null||v(r,k)),f}),E=p[1]||(()=>{const r=[],f=d=>{try{d()}catch(c){r.push(c)}};do{u.f&&f(u.f);const d=new Set,c=d.add.bind(d);o.forEach(i=>{var l;return(l=t.get(i))==null?void 0:l.l.forEach(c)}),o.clear(),a.forEach(c),a.clear(),s.forEach(c),s.clear(),d.forEach(f),o.size&&C()}while(o.size||a.size||s.size);if(r.length)throw new AggregateError(r)}),C=p[2]||(()=>{const r=[],f=new WeakSet,d=new WeakSet,c=Array.from(o);for(;c.length;){const i=c[c.length-1],l=_(i);if(d.has(i)){c.pop();continue}if(f.has(i)){if(n.get(i)===l.n)r.push([i,l]);else if((R?"production":void 0)!=="production"&&n.has(i))throw new Error("[Bug] invalidated atom exists");d.add(i),c.pop();continue}f.add(i);for(const y of ne(i,l,t))f.has(y)||c.push(y)}for(let i=r.length-1;i>=0;--i){const[l,y]=r[i];let b=!1;for(const I of y.d.keys())if(I!==l&&o.has(I)){b=!0;break}b&&(T(l),P(l)),n.delete(l)}}),T=p[3]||(r=>{var f;const d=_(r);if(ee(d)&&(t.has(r)&&n.get(r)!==d.n||Array.from(d.d).every(([S,O])=>T(S).n===O)))return d;d.d.clear();let c=!0;const i=()=>{t.has(r)&&(P(r),C(),E())},l=S=>{var O;if(m(r,S)){const Q=_(S);if(!ee(Q))if(H(S))X(S,S.init,_);else throw new Error("no atom init");return W(Q)}const J=T(S);try{return W(J)}finally{d.d.set(S,J.n),te(d.v)&&de(r,d.v,J),(O=t.get(S))==null||O.t.add(r),c||i()}};let y,b;const I={get signal(){return y||(y=new AbortController),y.signal},get setSelf(){return(R?"production":void 0)!=="production"&&!K(r)&&console.warn("setSelf function cannot be used with read-only atom"),!b&&K(r)&&(b=(...S)=>{if((R?"production":void 0)!=="production"&&c&&console.warn("setSelf function cannot be called in sync"),!c)try{return D(r,...S)}finally{C(),E()}}),b}},N=d.n;try{const S=h(r,l,I);return X(r,S,_),M(S)&&(ue(S,()=>y==null?void 0:y.abort()),S.then(i,i)),d}catch(S){return delete d.v,d.e=S,++d.n,d}finally{c=!1,N!==d.n&&n.get(r)===N&&(n.set(r,d.n),o.add(r),(f=u.c)==null||f.call(u,r))}}),U=p[4]||(r=>{const f=[r];for(;f.length;){const d=f.pop(),c=_(d);for(const i of ne(d,c,t)){const l=_(i);n.set(i,l.n),f.push(i)}}}),D=p[5]||((r,...f)=>{let d=!0;const c=l=>W(T(l)),i=(l,...y)=>{var b;const I=_(l);try{if(m(r,l)){if(!H(l))throw new Error("atom not writable");const N=I.n,S=y[0];X(l,S,_),P(l),N!==I.n&&(o.add(l),(b=u.c)==null||b.call(u,l),U(l));return}else return D(l,...y)}finally{d||(C(),E())}};try{return w(r,c,i,...f)}finally{d=!1}}),P=p[6]||(r=>{var f;const d=_(r),c=t.get(r);if(c&&!te(d.v)){for(const[i,l]of d.d)if(!c.d.has(i)){const y=_(i);z(i).t.add(r),c.d.add(i),l!==y.n&&(o.add(i),(f=u.c)==null||f.call(u,i),U(i))}for(const i of c.d||[])if(!d.d.has(i)){c.d.delete(i);const l=G(i);l==null||l.t.delete(r)}}}),z=p[7]||(r=>{var f;const d=_(r);let c=t.get(r);if(!c){T(r);for(const i of d.d.keys())z(i).t.add(r);if(c={l:new Set,d:new Set(d.d.keys()),t:new Set},t.set(r,c),(f=u.m)==null||f.call(u,r),K(r)){const i=()=>{let l=!0;const y=(...b)=>{try{return D(r,...b)}finally{l||(C(),E())}};try{const b=g(r,y);b&&(c.u=()=>{l=!0;try{b()}finally{l=!1}})}finally{l=!1}};s.add(i)}}return c}),G=p[8]||(r=>{var f;const d=_(r);let c=t.get(r);if(c&&!c.l.size&&!Array.from(c.t).some(i=>{var l;return(l=t.get(i))==null?void 0:l.d.has(r)})){c.u&&a.add(c.u),c=void 0,t.delete(r),(f=u.u)==null||f.call(u,r);for(const i of d.d.keys()){const l=G(i);l==null||l.t.delete(r)}return}return c}),Se=[e,t,n,o,s,a,u,h,w,v,g,_,E,C,T,U,D,P,z,G],k={get:r=>W(T(r)),set:(r,...f)=>{try{return D(r,...f)}finally{C(),E()}},sub:(r,f)=>{const c=z(r).l;return c.add(f),E(),()=>{c.delete(f),G(r),E()}}};return Object.defineProperty(k,Pe,{value:Se}),k},ae=ze,Ge=Re,re=ue,F={};let Ne=0;function Oe(e,t){const n=`atom${++Ne}`,o={toString(){return(F?"production":void 0)!=="production"&&this.debugLabel?n+":"+this.debugLabel:n}};return typeof e=="function"?o.read=e:(o.init=e,o.read=We,o.write=Ve),o}function We(e){return e(this)}function Ve(e,t,n){return t(this,typeof n=="function"?n(e(this)):n)}const Me=()=>{let e=0;const t=Ge({}),n=new WeakMap,o=new WeakMap,s=ae(n,o,void 0,void 0,void 0,void 0,t,void 0,(h,w,v,...g)=>e?v(h,...g):h.write(w,v,...g)),a=new Set;return t.m.add(void 0,h=>{a.add(h);const w=n.get(h);w.m=o.get(h)}),t.u.add(void 0,h=>{a.delete(h);const w=n.get(h);delete w.m}),Object.assign(s,{dev4_get_internal_weak_map:()=>(console.log("Deprecated: Use devstore from the devtools library"),n),dev4_get_mounted_atoms:()=>a,dev4_restore_atoms:h=>{const w={read:()=>null,write:(v,g)=>{++e;try{for(const[p,_]of h)"init"in p&&g(p,_)}finally{--e}}};s.set(w)}})};function fe(){return(F?"production":void 0)!=="production"?Me():ae()}let L;function Ue(){return L||(L=fe(),(F?"production":void 0)!=="production"&&(globalThis.__JOTAI_DEFAULT_STORE__||(globalThis.__JOTAI_DEFAULT_STORE__=L),globalThis.__JOTAI_DEFAULT_STORE__!==L&&console.warn("Detected multiple Jotai instances. It may cause unexpected behavior with the default store. https://github.com/pmndrs/jotai/discussions/2044"))),L}const ke={},ve=A.createContext(void 0);function _e(e){return A.useContext(ve)||Ue()}function Je({children:e,store:t}){const n=A.useRef(void 0);return!t&&!n.current&&(n.current=fe()),A.createElement(ve.Provider,{value:t||n.current},e)}const Y=e=>typeof(e==null?void 0:e.then)=="function",q=e=>{e.status||(e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}))},Ke=le.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(q(e),e)}),B=new WeakMap,oe=(e,t)=>{let n=B.get(e);return n||(n=new Promise((o,s)=>{let a=e;const u=v=>g=>{a===v&&o(g)},h=v=>g=>{a===v&&s(g)},w=()=>{try{const v=t();Y(v)?(B.set(v,n),a=v,v.then(u(v),h(v)),re(v,w)):o(v)}catch(v){s(v)}};e.then(u(e),h(e)),re(e,w)}),B.set(e,n)),n};function Xe(e,t){const{delay:n,unstable_promiseStatus:o=!le.use}={},s=_e(),[[a,u,h],w]=A.useReducer(g=>{const p=s.get(e);return Object.is(g[0],p)&&g[1]===s&&g[2]===e?g:[p,s,e]},void 0,()=>[s.get(e),s,e]);let v=a;if((u!==s||h!==e)&&(w(),v=s.get(e)),A.useEffect(()=>{const g=s.sub(e,()=>{if(o)try{const p=s.get(e);Y(p)&&q(oe(p,()=>s.get(e)))}catch{}if(typeof n=="number"){setTimeout(w,n);return}w()});return w(),g},[s,e,n,o]),A.useDebugValue(v),Y(v)){const g=oe(v,()=>s.get(e));return o&&q(g),Ke(g)}return v}function he(e,t){const n=_e();return A.useCallback((...s)=>{if((ke?"production":void 0)!=="production"&&!("write"in e))throw new Error("not writable atom");return n.set(e,...s)},[n,e])}function $e(e,t){return[Xe(e),he(e)]}const ge=Oe(be(30,30));var j=(e=>(e.CHECKBOX="checkbox",e.DIV="div",e))(j||{});function Be({gridType:e,cellSize:t}){const[n,o]=$e(ge),s=(a,u)=>{o(h=>xe(h,[a,u]))};switch(e){case j.CHECKBOX:return x.jsx(ye,{grid:n,cellSize:t,toggleCell:s});case j.DIV:return x.jsx(Ee,{grid:n,cellSize:t,toggleCell:s});default:throw new Error(`Unsupported grid type: ${e}`)}}function se({text:e,gridType:t,state:n}){const[o,s]=n;return x.jsx(Z,{text:e,onClick:()=>s(t),disabled:t===o})}const Ze=500;function Ye(){const e=he(ge),t=()=>e(u=>je(u)),n=()=>e(u=>Ie(u)),o=()=>e(u=>Te(u)),[s,a]=Ce(Ze,t);return x.jsx(Ae,{isAutoGenerating:s,toggleAutoGeneration:a,nextGeneration:t,randomize:n,clear:o})}const qe="_root_12k38_1",Fe="_gridContainer_12k38_7",ie={root:qe,gridContainer:Fe},Qe=4,me=30,He=16,ce=4;function st(){const e=A.useState(j.CHECKBOX),[t]=e,[n,o]=A.useState(He),s=()=>{o(u=>Math.max(u-ce,Qe))},a=()=>{o(u=>Math.min(u+ce,me))};return x.jsx(pe,{title:"Jotai",subtitle:"State management",children:x.jsx(Je,{children:x.jsxs("div",{className:ie.root,children:[x.jsxs(we,{children:[x.jsx(se,{text:"Checkbox grid",gridType:j.CHECKBOX,state:e}),x.jsx(se,{text:"Div grid",gridType:j.DIV,state:e}),x.jsx(Z,{text:"Reduce size",onClick:s}),x.jsx(Z,{text:"Increase size",onClick:a})]}),x.jsx(Ye,{}),x.jsx("div",{className:ie.gridContainer,children:x.jsx(Be,{gridType:t,cellSize:n})})]})})})}export{st as default};
