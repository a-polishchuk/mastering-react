import{r as x,a as ae,j as E,B as Z,C as de,T as ve}from"./index-DVTBwKMH.js";import{C as he}from"./CheckboxGrid-Bp-ULLs0.js";import{D as Se}from"./DivGrid-C2Mi-lhC.js";import{e as ye,t as ge,u as we,G as Ce,n as Ee,r as _e,c as pe}from"./useAutoGeneration-tmphj18L.js";const k=(e,t)=>e.unstable_is?e.unstable_is(t):t===e,q=e=>"init"in e,Q=e=>!!e.write,F=e=>"v"in e||"e"in e,N=e=>{if("e"in e)throw e.e;return e.v},ne=Symbol(),B=e=>e[ne],$=e=>{var t;return J(e)&&!((t=B(e))!=null&&t[1])},xe=(e,t)=>{const r=B(e);r&&(r[1]=!0,r[0].forEach(i=>i(t)))},be=e=>{if(B(e))return;const t=[new Set,!1];e[ne]=t;const r=()=>{t[1]=!0};e.then(r,r),e.onCancel=i=>{t[0].add(i)}},J=e=>typeof(e==null?void 0:e.then)=="function",re=(e,t,r)=>{r.p.has(e)||(r.p.add(e),t.then(()=>{r.p.delete(e)},()=>{r.p.delete(e)}))},X=(e,t,r)=>{const i=r(e),f="v"in i,h=i.v,l=$(i.v)?i.v:null;if(J(t)){be(t);for(const C of i.d.keys())re(e,t,r(C))}i.v=t,delete i.e,(!f||!Object.is(h,i.v))&&(++i.n,l&&xe(l,t))},H=(e,t,r)=>{var i;const f=new Set;for(const h of((i=r.get(e))==null?void 0:i.t)||[])r.has(h)&&f.add(h);for(const h of t.p)f.add(h);return f},je=Symbol(),Pe=(e=new WeakMap,t=new WeakMap,r=new WeakMap,i=new Set,f=new Set,h=new Set,l={},C=(d,...g)=>d.read(...g),p=(d,...g)=>d.write(...g),a=(d,g)=>{var _;return(_=d.unstable_onInit)==null?void 0:_.call(d,g)},G=(d,g)=>{var _;return(_=d.onMount)==null?void 0:_.call(d,g)},...b)=>{const d=b[0]||(n=>{let u=e.get(n);return u||(u={d:new Map,p:new Set,n:0},e.set(n,u),a==null||a(n,O)),u}),g=b[1]||(()=>{let n,u;const v=s=>{try{s()}catch(o){n||(n=!0,u=o)}};do{l.f&&v(l.f);const s=new Set,o=s.add.bind(s);i.forEach(c=>{var w;return(w=t.get(c))==null?void 0:w.l.forEach(o)}),i.clear(),h.forEach(o),h.clear(),f.forEach(o),f.clear(),s.forEach(v),i.size&&_()}while(i.size||h.size||f.size);if(n)throw u}),_=b[2]||(()=>{const n=[],u=new WeakSet,v=new WeakSet,s=Array.from(i);for(;s.length;){const o=s[s.length-1],c=d(o);if(v.has(o)){s.pop();continue}if(u.has(o)){r.get(o)===c.n&&n.push([o,c]),v.add(o),s.pop();continue}u.add(o);for(const w of H(o,c,t))u.has(w)||s.push(w)}for(let o=n.length-1;o>=0;--o){const[c,w]=n[o];let y=!1;for(const j of w.d.keys())if(j!==c&&i.has(j)){y=!0;break}y&&(P(c),R(c)),r.delete(c)}}),P=b[3]||(n=>{var u,v;const s=d(n);if(F(s)&&(t.has(n)&&r.get(n)!==s.n||Array.from(s.d).every(([S,A])=>P(S).n===A)))return s;s.d.clear();let o=!0;const c=()=>{t.has(n)&&(R(n),_(),g())},w=S=>{var A;if(k(n,S)){const Y=d(S);if(!F(Y))if(q(S))X(S,S.init,d);else throw new Error("no atom init");return N(Y)}const M=P(S);try{return N(M)}finally{s.d.set(S,M.n),$(s.v)&&re(n,s.v,M),(A=t.get(S))==null||A.t.add(n),o||c()}};let y,j;const K={get signal(){return y||(y=new AbortController),y.signal},get setSelf(){return!j&&Q(n)&&(j=(...S)=>{if(!o)try{return D(n,...S)}finally{_(),g()}}),j}},z=s.n;try{const S=C(n,w,K);return X(n,S,d),J(S)&&((u=S.onCancel)==null||u.call(S,()=>y==null?void 0:y.abort()),S.then(c,c)),s}catch(S){return delete s.v,s.e=S,++s.n,s}finally{o=!1,z!==s.n&&r.get(n)===z&&(r.set(n,s.n),i.add(n),(v=l.c)==null||v.call(l,n))}}),W=b[4]||(n=>{const u=[n];for(;u.length;){const v=u.pop(),s=d(v);for(const o of H(v,s,t)){const c=d(o);r.set(o,c.n),u.push(o)}}}),D=b[5]||((n,...u)=>{let v=!0;const s=c=>N(P(c)),o=(c,...w)=>{var y;const j=d(c);try{if(k(n,c)){if(!q(c))throw new Error("atom not writable");const K=j.n,z=w[0];X(c,z,d),R(c),K!==j.n&&(i.add(c),(y=l.c)==null||y.call(l,c),W(c));return}else return D(c,...w)}finally{v||(_(),g())}};try{return p(n,s,o,...u)}finally{v=!1}}),R=b[6]||(n=>{var u;const v=d(n),s=t.get(n);if(s&&!$(v.v)){for(const[o,c]of v.d)if(!s.d.has(o)){const w=d(o);L(o).t.add(n),s.d.add(o),c!==w.n&&(i.add(o),(u=l.c)==null||u.call(l,o),W(o))}for(const o of s.d||[])if(!v.d.has(o)){s.d.delete(o);const c=T(o);c==null||c.t.delete(n)}}}),L=b[7]||(n=>{var u;const v=d(n);let s=t.get(n);if(!s){P(n);for(const o of v.d.keys())L(o).t.add(n);if(s={l:new Set,d:new Set(v.d.keys()),t:new Set},t.set(n,s),(u=l.m)==null||u.call(l,n),Q(n)){const o=()=>{let c=!0;const w=(...y)=>{try{return D(n,...y)}finally{c||(_(),g())}};try{const y=G(n,w);y&&(s.u=()=>{c=!0;try{y()}finally{c=!1}})}finally{c=!1}};f.add(o)}}return s}),T=b[8]||(n=>{var u;const v=d(n);let s=t.get(n);if(s&&!s.l.size&&!Array.from(s.t).some(o=>{var c;return(c=t.get(o))==null?void 0:c.d.has(n)})){s.u&&h.add(s.u),s=void 0,t.delete(n),(u=l.u)==null||u.call(l,n);for(const o of v.d.keys()){const c=T(o);c==null||c.t.delete(n)}return}return s}),fe=[e,t,r,i,f,h,l,C,p,a,G,d,g,_,P,W,D,R,L,T],O={get:n=>N(P(n)),set:(n,...u)=>{try{return D(n,...u)}finally{_(),g()}},sub:(n,u)=>{const s=L(n).l;return s.add(u),g(),()=>{s.delete(u),T(n),g()}}};return Object.defineProperty(O,je,{value:fe}),O},Ie=Pe;let Ge=0;function De(e,t){const r=`atom${++Ge}`,i={toString(){return r}};return typeof e=="function"?i.read=e:(i.init=e,i.read=Re,i.write=Le),i}function Re(e){return e(this)}function Le(e,t,r){return t(this,typeof r=="function"?r(e(this)):r)}const se=()=>Ie();let U;const Te=()=>(U||(U=se()),U),oe=x.createContext(void 0),ie=e=>x.useContext(oe)||Te(),ze=({children:e,store:t})=>{const r=x.useRef(void 0);return!t&&!r.current&&(r.current=se()),x.createElement(oe.Provider,{value:t||r.current},e)},ce=e=>typeof(e==null?void 0:e.then)=="function",Ae=e=>{e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t})},Ne=ae.use||(e=>{if(e.status==="pending")throw e;if(e.status==="fulfilled")return e.value;throw e.status==="rejected"?e.reason:(Ae(e),e)}),V=new WeakMap,We=e=>{let t=V.get(e);return t||(t=new Promise((r,i)=>{let f=e;const h=p=>a=>{f===p&&r(a)},l=p=>a=>{f===p&&i(a)},C=p=>{"onCancel"in p&&typeof p.onCancel=="function"&&p.onCancel(a=>{ce(a)?(V.set(a,t),f=a,a.then(h(a),l(a)),C(a)):r(a)})};e.then(h(e),l(e)),C(e)}),V.set(e,t)),t};function Oe(e,t){const r=ie(),[[i,f,h],l]=x.useReducer(a=>{const G=r.get(e);return Object.is(a[0],G)&&a[1]===r&&a[2]===e?a:[G,r,e]},void 0,()=>[r.get(e),r,e]);let C=i;if((f!==r||h!==e)&&(l(),C=r.get(e)),x.useEffect(()=>{const a=r.sub(e,()=>{l()});return l(),a},[r,e,void 0]),x.useDebugValue(C),ce(C)){const a=We(C);return Ne(a)}return C}function le(e,t){const r=ie();return x.useCallback((...f)=>r.set(e,...f),[r,e])}function Ke(e,t){return[Oe(e),le(e)]}const ue=De(ye(30,30));var I=(e=>(e.CHECKBOX="checkbox",e.DIV="div",e))(I||{});function Me({gridType:e,cellSize:t}){const[r,i]=Ke(ue),f=(h,l)=>{i(C=>ge(C,[h,l]))};switch(e){case I.CHECKBOX:return E.jsx(he,{grid:r,cellSize:t,toggleCell:f});case I.DIV:return E.jsx(Se,{grid:r,cellSize:t,toggleCell:f});default:throw new Error(`Unsupported grid type: ${e}`)}}function m({text:e,gridType:t,state:r}){const[i,f]=r;return E.jsx(Z,{text:e,onClick:()=>f(t),disabled:t===i})}const Xe=500;function Ue(){const e=le(ue),t=()=>e(l=>Ee(l)),r=()=>e(l=>_e(l)),i=()=>e(l=>pe(l)),[f,h]=we(Xe,t);return E.jsx(Ce,{isAutoGenerating:f,toggleAutoGeneration:h,nextGeneration:t,randomize:r,clear:i})}const Ve="_root_vr7xl_1",Ze="_gridContainer_vr7xl_7",ee={root:Ve,gridContainer:Ze},$e=4,Be=30,Je=16,te=4;function Fe(){const e=x.useState(I.CHECKBOX),[t]=e,[r,i]=x.useState(Je),f=()=>{i(l=>Math.max(l-te,$e))},h=()=>{i(l=>Math.min(l+te,Be))};return E.jsx(de,{title:"Jotai",subtitle:"State management",children:E.jsx(ze,{children:E.jsxs("div",{className:ee.root,children:[E.jsxs(ve,{children:[E.jsx(m,{text:"Checkbox grid",gridType:I.CHECKBOX,state:e}),E.jsx(m,{text:"Div grid",gridType:I.DIV,state:e}),E.jsx(Z,{text:"Reduce size",onClick:f}),E.jsx(Z,{text:"Increase size",onClick:h})]}),E.jsx(Ue,{}),E.jsx("div",{className:ee.gridContainer,children:E.jsx(Me,{gridType:t,cellSize:r})})]})})})}export{Fe as default};
